<div id="smart-button-container">
    <details>
        <summary>Upgrade your membership</summary>
        <div style="text-align: center;">
        <p>
            Use PayPal to pay the $30 SAIL membership due.
            <div id="paypal-button-container"></div>
        </p>
        </div>
    </details>
</div>
<script src="https://www.paypal.com/sdk/js?client-id=sb&enable-funding=venmo&currency=USD" data-sdk-integration-source="button-factory"></script>
<script>
function initPayPalButton() {
    paypal.Buttons({
    style: {
        shape: 'rect',
        color: 'gold',
        layout: 'vertical',
        label: 'paypal',
        
    },

    createOrder: function(data, actions) {
        return actions.order.create({
        purchase_units: [{"description":"2021-2022 SAIL Membership","amount":{"currency_code":"USD","value":30}}]
        });
    },

    onApprove: function(data, actions) {
        return actions.order.capture().then(function(orderData) {
        
        // Show a success message within this page.
        const element = document.getElementById('paypal-button-container');
        element.innerHTML = '';
        element.innerHTML = "<p>Thank you for upgrading your membership! "
            + "Your dues will help to fund SAIL events and you will now have access to Friendship Connect and the full housing roadmap.</p>";

        // Post membership update request
        fetch('/wp-json/membership/v1/dues', { method: 'POST', body: JSON.stringify(orderData)});
        
        });
    },

    onError: function(err) {
        console.log(err);
    }
    }).render('#paypal-button-container');
}
let isPaid = {{isPaidMember}};
if (isPaid) {
    const element = document.getElementById('paypal-button-container');
    element.innerHTML = 'Your account has access to paid member features. Your access will expire at the end of 2022';
} else {
    initPayPalButton();
}
</script>